# tomcat

> This library helps you deploy [an Apache Tomcat server](http://tomcat.apache.org/) to your cluster.
Tomcat is an open-source web server that is primarily used to run Java web applications (i.e. via servlets and JSP).

* [Quickstart](#quickstart)
* [Prototype Reference](#prototype-reference)
  * [io.ksonnet.pkg.persistent-tomcat](#io.ksonnet.pkg.persistent-tomcat)
  * [io.ksonnet.pkg.non-persistent-tomcat](#io.ksonnet.pkg.non-persistent-tomcat)

Specifically, the *tomcat* library files provide:
* A set of relevant **parts** (_e.g._, deployments, services, secrets, and so on) that can be combined to configure an Apache Tomcat server for a wide variety of scenarios.

* A set of **prototypes**, which are pre-fabricated "flavors" (or "distributions") of *tomcat*, each configured for a different use case. By passing in certain parameters, users can interactively customize these prototypes for their specific needs.

## Quickstart

*Using the [`io.ksonnet.pkg.persistent-tomcat`](io.ksonnet.pkg.persistent-tomcat) prototype, the following commands generate the Kubernetes YAML for an Apache Tomcat server, and then deploys it to your Kubernetes cluster.*

1. First, create a cluster and install the ksonnet CLI (see root-level [README.md](rootReadme)).

2. If you haven't yet created a [ksonnet application](linkToSomewhere), do so using `ks init <app-name>`.

3. Finally, in the ksonnet application directory, run the following:

```shell
# Expand prototype as a Jsonnet file, place in a file in the
# `components/` directory. (YAML and JSON are also available.)
$ ks prototype use io.ksonnet.pkg.persistent-tomcat tomcat \
  --name tomcat \
  --namespace default \
  --tomcatUser frank \
  --tomcatPassword boots

# Apply to server.
$ ks apply -f tomcat.jsonnet
```

## Prototype Reference

The set of available prototypes are enumerated below.

  * [io.ksonnet.pkg.persistent-tomcat](#io.ksonnet.pkg.persistent-tomcat)
  * [io.ksonnet.pkg.non-persistent-tomcat](#io.ksonnet.pkg.non-persistent-tomcat)

### io.ksonnet.pkg.persistent-tomcat

When generated and applied, this prototype deploys a stateful Tomcat server. It is backed by a PersistentVolumeClaim, runs as a Deployment, and is exposed to the network with a Service. The password is stored in a Secret.

#### Example

```shell
# Expand prototype as a Jsonnet file, place in a file in the
# `components/` directory. (YAML and JSON are also available.)
$ ks prototype use io.ksonnet.pkg.persistent-tomcat tomcat \
  --namespace YOUR_NAMESPACE_HERE \
  --name YOUR_NAME_HERE \
  --tomcatUser YOUR_TOMCATUSER_HERE \
  --tomcatPassword YOUR_TOMCATPASSWORD_HERE
```

Below is the Jsonnet file generated by this command.

```
// tomcat.jsonnet
<JSONNET HERE>
```

#### Parameters

The available options to pass to the prototype are:

| Name | Type | Description|
| --- | --- | --- |
| `--namespace` | *string* | Namespace (metadata) that the Tomcat resources are created under |
| `--name` | *string* | Name (metadata) to identify all resources defined by this prototype |
| `--tomcatUser` | *string* | Username for the Tomcat manager page. If not specified, Tomcat will not assign users. |
| `--tomcatPassword` | *string* | Password for the Tomcat manager page. |
### io.ksonnet.pkg.non-persistent-tomcat

When generated and applied, this prototype deploys a stateless Tomcat server. *NOTE: It is NOT backed by a PersistentVolumeClaim*. It runs as a Deployment, and is exposed to the network with a Service. The password is stored in a Secret.

#### Example

```shell
# Expand prototype as a Jsonnet file, place in a file in the
# `components/` directory. (YAML and JSON are also available.)
$ ks prototype use io.ksonnet.pkg.non-persistent-tomcat tomcat \
  --namespace YOUR_NAMESPACE_HERE \
  --name YOUR_NAME_HERE \
  --tomcatUser YOUR_TOMCATUSER_HERE \
  --tomcatPassword YOUR_TOMCATPASSWORD_HERE
```

Below is the Jsonnet file generated by this command.

```
// tomcat.jsonnet
<JSONNET HERE>
```

#### Parameters

The available options to pass to the prototype are:

| Name | Type | Description|
| --- | --- | --- |
| `--namespace` | *string* | Namespace (metadata) that the Tomcat resources are created under |
| `--name` | *string* | Name (metadata) to identify all resources defined by this prototype |
| `--tomcatUser` | *string* | Username for the Tomcat manager page. If not specified, Tomcat will not assign users. |
| `--tomcatPassword` | *string* | Password for the Tomcat manager page. |


[rootReadme]: https://github.com/ksonnet/mixins
